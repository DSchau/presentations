import { FullScreenCode, Main, Section, SectionInverted } from 'gatsby-mdx-theme'
import Player from 'react-player'
import { Buffering, IntersectionObserverExample, Link, Prefetch } from '../components'

export default SectionInverted

# Modern APIs + Gatsby

---

## This is the _fun_ part ðŸŽ‰

---

1. `IntersectionObserver`
1. `<link rel="prefetch">`
1. Responsive images

---

## `IntersectionObserver`

### A browser API to perform some action when some element enters the viewport

---

<iframe src="https://codesandbox.io/embed/l70jj9p58m?view=preview" style={{ height: '80vh', width: '80vw' }} sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe>

---

## `<link rel="prefetch">`

### Prefetch the _next_ resource(s) when the browser is idle

---

<Prefetch />

---

## But wait, there's more!

---

<img alt="Addy Osmani (from Google) sent a pull request optimizing Gatsby's pre-fetch behavior for all users, particularly those on slower connections" src="./assets/addy-pr.png" style={{ height: '100vh'}} />

---

export default FullScreenCode

```jsx
// Skip prefetching if we know user is on slow or constrained connection
if (`connection` in navigator) {
  if ((navigator.connection.effectiveType || ``).includes(`2g`)) {
    return false
  }
  if (navigator.connection.saveData) {
    return false
  }
}
```

---

## Responsive, lazily loaded images

### with `gatsby-image`

---

<a href="https://using-gatsby-image.gatsbyjs.org/" rel="noreferer noopener" target="_blank"><Player url="./assets/using-gatsby-image.mp4" playing={true} loop={true} height="100vh" /></a>

---

- âœ… Load (larger) images once they enter the viewport
- âœ… Prefetch the page(s) in the background once they enter the viewport
- (we'll come back to this!)

---

## Gatsby is _your_ compiler for the web

<img alt="Gatsby logo representing a helpful astronaut/butler to serve as your guide" src="./assets/gatsby-astronaut.png" style={{ maxHeight: '35vh', marginTop: '2.5vh' }} />

---

<Buffering />
